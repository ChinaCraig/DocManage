<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶ˆæ¯æ»šåŠ¨æµ‹è¯•</title>
    <link href="/static/css/message_components.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
        }

        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .test-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .chat-area {
            height: 500px; /* å›ºå®šé«˜åº¦æ¨¡æ‹ŸèŠå¤©åŒºåŸŸ */
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .messages-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            gap: 15px;
            /* ç¾åŒ–æ»šåŠ¨æ¡ */
            scrollbar-width: thin;
            scrollbar-color: #cbd5e0 #f7fafc;
        }

        .messages-container::-webkit-scrollbar {
            width: 8px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }

        .messages-container::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }

        .add-message-btn {
            margin: 20px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .add-message-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }

        .info-panel {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px;
            font-size: 14px;
            color: #1976d2;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸ“œ æ¶ˆæ¯æ»šåŠ¨æµ‹è¯•</h1>
            <p>æµ‹è¯•å¤šæ¡æ¶ˆæ¯æ—¶çš„æ»šåŠ¨æ•ˆæœå’Œæ ·å¼ä¿æŒ</p>
        </div>

        <div class="info-panel">
            <strong>æµ‹è¯•è¯´æ˜ï¼š</strong>
            <ul>
                <li>ç‚¹å‡»"æ·»åŠ æ¶ˆæ¯"æŒ‰é’®å¢åŠ æ›´å¤šæ¶ˆæ¯</li>
                <li>è§‚å¯Ÿå½“æ¶ˆæ¯è¶…è¿‡å®¹å™¨é«˜åº¦æ—¶æ˜¯å¦å‡ºç°æ»šåŠ¨æ¡</li>
                <li>ç¡®è®¤å†å²æ¶ˆæ¯çš„æ ·å¼ä¸ä¼šè¢«å‹ç¼©æˆ–æ”¹å˜</li>
                <li>éªŒè¯æ–°æ¶ˆæ¯ä¼šè‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨</li>
            </ul>
        </div>

        <div class="chat-area">
            <div class="messages-container" id="messagesContainer">
                <!-- åˆå§‹æ¶ˆæ¯ -->
                <div class="message-container" data-role="user">
                    <div class="message-header">
                        <div class="message-role">ç”¨æˆ·</div>
                        <div class="message-time">10:00:01</div>
                    </div>
                    <div class="message-content">
                        <div class="content-text regular-text">
                            ä½ å¥½ï¼Œè¯·å¸®æˆ‘æœç´¢ä¸€äº›æŠ€æœ¯æ–‡æ¡£ã€‚
                        </div>
                    </div>
                </div>

                <div class="message-container" data-role="assistant">
                    <div class="message-header">
                        <div class="message-role">AIåŠ©æ‰‹</div>
                        <div class="message-time">10:00:05</div>
                    </div>
                    <div class="message-content">
                        <div class="intent-info">
                            <span class="intent-badge knowledge_search">çŸ¥è¯†æ£€ç´¢</span>
                            <span class="confidence-score">ç½®ä¿¡åº¦: 95%</span>
                        </div>
                        <div class="content-text intent-analysis">
                            ğŸ¯ æ„å›¾è¯†åˆ«: ç”¨æˆ·è¦æ±‚è¿›è¡ŒæŠ€æœ¯æ–‡æ¡£æœç´¢ï¼Œå·²è¯†åˆ«ä¸ºçŸ¥è¯†åº“æ£€ç´¢æ“ä½œ
                        </div>
                        <div class="content-markdown">
                            <h3>æœç´¢ç»“æœ</h3>
                            <p>æˆ‘ä¸ºæ‚¨æ‰¾åˆ°äº†ä»¥ä¸‹æŠ€æœ¯æ–‡æ¡£ï¼š</p>
                            <ul>
                                <li><strong>ç³»ç»Ÿæ¶æ„è®¾è®¡</strong> - è¯¦ç»†ä»‹ç»äº†æ•´ä½“æ¶æ„</li>
                                <li><strong>APIæ¥å£æ–‡æ¡£</strong> - åŒ…å«æ‰€æœ‰æ¥å£çš„ä½¿ç”¨è¯´æ˜</li>
                                <li><strong>éƒ¨ç½²æŒ‡å—</strong> - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ­¥éª¤</li>
                            </ul>
                        </div>
                        <div class="content-table-container">
                            <table class="content-table">
                                <thead>
                                    <tr>
                                        <th>æ–‡æ¡£åç§°</th>
                                        <th>ç›¸å…³åº¦</th>
                                        <th>æ–‡ä»¶ç±»å‹</th>
                                        <th>æœ€åä¿®æ”¹</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>é¡¹ç›®éœ€æ±‚æ–‡æ¡£.pdf</td>
                                        <td>0.95</td>
                                        <td>PDF</td>
                                        <td>2025-06-18</td>
                                    </tr>
                                    <tr>
                                        <td>æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡.docx</td>
                                        <td>0.87</td>
                                        <td>Word</td>
                                        <td>2025-06-17</td>
                                    </tr>
                                    <tr>
                                        <td>æ•°æ®åˆ†ææŠ¥å‘Š.xlsx</td>
                                        <td>0.76</td>
                                        <td>Excel</td>
                                        <td>2025-06-16</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="add-message-btn" onclick="addTestMessage()">
                ğŸ“ æ·»åŠ æ¶ˆæ¯
            </button>
        </div>
    </div>

    <script>
        let messageCount = 2;
        
        function addTestMessage() {
            const container = document.getElementById('messagesContainer');
            messageCount++;
            
            const isUser = messageCount % 2 === 1;
            const role = isUser ? 'user' : 'assistant';
            const time = new Date().toLocaleTimeString();
            
            let messageHTML;
            
            if (isUser) {
                messageHTML = `
                    <div class="message-container" data-role="user">
                        <div class="message-header">
                            <div class="message-role">ç”¨æˆ·</div>
                            <div class="message-time">${time}</div>
                        </div>
                        <div class="message-content">
                            <div class="content-text regular-text">
                                è¿™æ˜¯ç¬¬ ${messageCount} æ¡æ¶ˆæ¯ã€‚è¯·ç»§ç»­ä¸ºæˆ‘æä¾›æ›´å¤šä¿¡æ¯ã€‚
                            </div>
                        </div>
                    </div>
                `;
            } else {
                const intentTypes = ['knowledge_search', 'normal_chat', 'mcp_action'];
                const intentLabels = ['çŸ¥è¯†æ£€ç´¢', 'æ™®é€šå¯¹è¯', 'MCPæ“ä½œ'];
                const intentIndex = Math.floor(Math.random() * 3);
                
                messageHTML = `
                    <div class="message-container" data-role="assistant">
                        <div class="message-header">
                            <div class="message-role">AIåŠ©æ‰‹</div>
                            <div class="message-time">${time}</div>
                        </div>
                        <div class="message-content">
                            <div class="intent-info">
                                <span class="intent-badge ${intentTypes[intentIndex]}">${intentLabels[intentIndex]}</span>
                                <span class="confidence-score">ç½®ä¿¡åº¦: ${Math.floor(Math.random() * 20 + 80)}%</span>
                            </div>
                            <div class="content-text intent-analysis">
                                ğŸ¯ æ„å›¾è¯†åˆ«: è¿™æ˜¯ç¬¬ ${messageCount} æ¡AIå›å¤çš„æ„å›¾åˆ†æä¿¡æ¯ã€‚ç³»ç»Ÿå·²å®Œæˆå¯¹ç”¨æˆ·è¯·æ±‚çš„æ·±åº¦åˆ†æï¼Œç¡®å®šäº†ç›¸åº”çš„å¤„ç†ç­–ç•¥å’Œå“åº”æ–¹å¼ã€‚
                            </div>
                            <div class="content-markdown">
                                <h3>AIå›å¤ #${messageCount}</h3>
                                <p>è¿™æ˜¯ç¬¬ ${messageCount} æ¡AIåŠ©æ‰‹çš„å›å¤ã€‚æ— è®ºæ·»åŠ å¤šå°‘æ¡æ¶ˆæ¯ï¼Œæ¯æ¡æ¶ˆæ¯çš„æ ·å¼éƒ½åº”è¯¥ä¿æŒä¸€è‡´ï¼Œä¸ä¼šè¢«å‹ç¼©æˆ–æ”¹å˜ã€‚</p>
                                <p><strong>é‡è¦ç‰¹æ€§ï¼š</strong></p>
                                <ul>
                                    <li>æ¶ˆæ¯å®¹å™¨ä¿æŒå›ºå®šçš„å†…è¾¹è·å’Œåœ†è§’</li>
                                    <li>å†…å®¹åŒºåŸŸä¸ä¼šè¢«å‹ç¼©</li>
                                    <li>æ„å›¾è¯†åˆ«ä¿¡æ¯å§‹ç»ˆåœ¨å³ä¸Šè§’</li>
                                    <li>æ»šåŠ¨æ¡å‡ºç°æ—¶å†å²æ¶ˆæ¯æ ·å¼ä¸å˜</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            container.insertAdjacentHTML('beforeend', messageHTML);
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
            container.scrollTop = container.scrollHeight;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ»šåŠ¨åˆ°åº•éƒ¨
        window.addEventListener('load', function() {
            const container = document.getElementById('messagesContainer');
            container.scrollTop = container.scrollHeight;
        });
    </script>
</body>
</html> 